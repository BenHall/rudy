<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Rudy::AWS::EC2::Instances [Rudy: Not your grandparents' EC2 deployment tool.]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Rudy::AWS::EC2::Instances
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../../files/lib/rudy/aws/ec2/instance_rb.html">lib/rudy/aws/ec2/instance.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000319">from_hash</a></li>
              <li><a href="#M000320">known_state?</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000311">any?</a></li>
              <li><a href="#M000313">any_group?</a></li>
              <li><a href="#M000307">attached_volume?</a></li>
              <li><a href="#M000306">console</a></li>
              <li><a href="#M000297">create</a></li>
              <li><a href="#M000299">destroy</a></li>
              <li><a href="#M000301">destroy_group</a></li>
              <li><a href="#M000309">device_volume</a></li>
              <li><a href="#M000312">exists?</a></li>
              <li><a href="#M000310">get</a></li>
              <li><a href="#M000302">list</a></li>
              <li><a href="#M000305">list_as_hash</a></li>
              <li><a href="#M000303">list_group</a></li>
              <li><a href="#M000304">list_group_as_hash</a></li>
              <li><a href="#M000315">pending?</a></li>
              <li><a href="#M000298">restart</a></li>
              <li><a href="#M000300">restart_group</a></li>
              <li><a href="#M000314">running?</a></li>
              <li><a href="#M000317">shutting_down?</a></li>
              <li><a href="#M000316">terminated?</a></li>
              <li><a href="#M000318">unavailable?</a></li>
              <li><a href="#M000308">volumes</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li><a href="../ObjectBase.html">Rudy::AWS::ObjectBase</a></li>
                <li><a href="Base.html">Rudy::AWS::EC2::Base</a></li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>KNOWN_STATES</td>
                    <td>=</td>
                    <td class='context-item-value'>[:running, :pending, :shutting_down, :terminated, :degraded].freeze</td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='public-class method' id='method-M000319'>
                <a name='M000319'>      </a>
                <div class='synopsis'>
                  <span class='name'>from_hash</span>
                  <span class='arguments'>(h)</span>
                </div>
                <div class='description'>
                  <p>
                  <tt>h</tt> is a hash of instance properties in the format returned by
                  EC2::Base#describe_instances:
                  </p>
                  <pre>kernelId: aki-9b00e5f2&#x000A;amiLaunchIndex: &quot;0&quot;&#x000A;keyName: solutious-default&#x000A;launchTime: &quot;2009-03-14T12:48:15.000Z&quot;&#x000A;instanceType: m1.small&#x000A;imageId: ami-0734d36e&#x000A;privateDnsName:&#x000A;reason:&#x000A;placement:&#x000A;  availabilityZone: us-east-1b&#x000A;dnsName:&#x000A;instanceId: i-cdaa34a4&#x000A;instanceState:&#x000A;  name: pending&#x000A;  code: &quot;0&quot;</pre>
                  <p>
                  Returns an <a href="Instance.html">Instance</a> object.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000319-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000319-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 374</span>&#x000A;374:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-identifier">h</span>)&#x000A;375:         <span class="ruby-identifier">inst</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span><span class="ruby-operator">::</span><span class="ruby-constant">Instance</span>.<span class="ruby-identifier">new</span>&#x000A;376:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">aki</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'kernelId'</span>]&#x000A;377:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">ami</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'imageId'</span>]&#x000A;378:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">launch_time</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'launchTime'</span>]&#x000A;379:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">keyname</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'keyName'</span>]&#x000A;380:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">launch_index</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'amiLaunchIndex'</span>]&#x000A;381:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">size</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'instanceType'</span>]&#x000A;382:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">dns_private</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'privateDnsName'</span>]&#x000A;383:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">dns_public</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'dnsName'</span>]&#x000A;384:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">reason</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'reason'</span>]&#x000A;385:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">zone</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'placement'</span>][<span class="ruby-value str">'availabilityZone'</span>]&#x000A;386:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">awsid</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'instanceId'</span>]&#x000A;387:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'instanceState'</span>][<span class="ruby-value str">'name'</span>]&#x000A;388:         <span class="ruby-identifier">inst</span>&#x000A;389:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-class method' id='method-M000320'>
                <a name='M000320'>      </a>
                <div class='synopsis'>
                  <span class='name'>known_state?</span>
                  <span class='arguments'>(state)</span>
                </div>
                <div class='description'>
                  <p>
                  Is <tt>state</tt> a known <a href="../EC2.html">EC2</a> machine instance
                  state? See: KNOWN_STATES
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000320-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000320-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 392</span>&#x000A;392:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">known_state?</span>(<span class="ruby-identifier">state</span>)&#x000A;393:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">state</span>&#x000A;394:         <span class="ruby-identifier">state</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">to_sym</span>&#x000A;395:         <span class="ruby-identifier">state</span> = <span class="ruby-identifier">:shutting_down</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:'shutting-down'</span>&#x000A;396:         <span class="ruby-constant">KNOWN_STATES</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">state</span>)&#x000A;397:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000311'>
                <a name='M000311'>      </a>
                <div class='synopsis'>
                  <span class='name'>any?</span>
                  <span class='arguments'>(state=:any, inst_ids=[])</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000311-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000311-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 317</span>&#x000A;317:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">any?</span>(<span class="ruby-identifier">state</span>=<span class="ruby-identifier">:any</span>, <span class="ruby-identifier">inst_ids</span>=[])&#x000A;318:         <span class="ruby-operator">!</span><span class="ruby-identifier">list</span>(<span class="ruby-identifier">state</span>, <span class="ruby-identifier">inst_ids</span>).<span class="ruby-identifier">nil?</span>&#x000A;319:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000313'>
                <a name='M000313'>      </a>
                <div class='synopsis'>
                  <span class='name'>any_group?</span>
                  <span class='arguments'>(group=nil, state=:any)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000313-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000313-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 325</span>&#x000A;325:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">any_group?</span>(<span class="ruby-identifier">group</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">state</span>=<span class="ruby-identifier">:any</span>)&#x000A;326:         <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">list_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-identifier">state</span>)&#x000A;327:         <span class="ruby-operator">!</span><span class="ruby-identifier">ret</span>.<span class="ruby-identifier">nil?</span>&#x000A;328:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000307'>
                <a name='M000307'>      </a>
                <div class='synopsis'>
                  <span class='name'>attached_volume?</span>
                  <span class='arguments'>(id, device)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000307-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000307-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 289</span>&#x000A;289:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attached_volume?</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">device</span>)&#x000A;290:         <span class="ruby-identifier">list</span> = <span class="ruby-identifier">volumes</span>(<span class="ruby-identifier">id</span>)&#x000A;291:         <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;292:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">device</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">device</span>&#x000A;293:         <span class="ruby-keyword kw">end</span>&#x000A;294:         <span class="ruby-keyword kw">false</span>&#x000A;295:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000306'>
                <a name='M000306'>      </a>
                <div class='synopsis'>
                  <span class='name'>console</span>
                  <span class='arguments'>(inst_id, &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <p>
                  System console output.
                  </p>
                  <ul>
                  <li><tt>inst_id</tt> instance ID (String) or <a
                  href="Instance.html">Instance</a> object.
                  
                  </li>
                  </ul>
                  <p>
                  NOTE: Amazon sends the console outputs as a Base64 encoded string. This
                  method DOES NOT decode in order to remain compliant with the data formats
                  returned by Amazon.
                  </p>
                  <p>
                  You can decode it like this:
                  </p>
                  <pre>require 'base64'&#x000A;Base64.decode64(output)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000306-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000306-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 281</span>&#x000A;281:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">console</span>(<span class="ruby-identifier">inst_id</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;282:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>([<span class="ruby-identifier">inst_id</span>])&#x000A;283:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">execute_request</span>({}) { &#x000A;284:           <span class="ruby-ivar">@ec2</span>.<span class="ruby-identifier">get_console_output</span>(<span class="ruby-identifier">:instance_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inst_ids</span>.<span class="ruby-identifier">first</span>)&#x000A;285:         }&#x000A;286:         <span class="ruby-identifier">response</span>[<span class="ruby-value str">'output'</span>]&#x000A;287:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000297'>
                <a name='M000297'>      </a>
                <div class='synopsis'>
                  <span class='name'>create</span>
                  <span class='arguments'>(opts={}, &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <p>
                  Return an Array of <a href="Instance.html">Instance</a> objects. Note:
                  These objects will not have DNS data because they will still be in pending
                  state. The DNS info becomes available once the instance enters the running
                  state.
                  </p>
                  <p>
                  <tt>opts</tt> supports the following parameters:
                  </p>
                  <ul>
                  <li><tt>:ami</tt>
                  
                  </li>
                  <li><tt>:group</tt>
                  
                  </li>
                  <li><tt>:size</tt>
                  
                  </li>
                  <li><tt>:keypair</tt>
                  
                  </li>
                  <li><tt>:private</tt> true or false (default)
                  
                  </li>
                  <li><tt>:machine_data</tt>
                  
                  </li>
                  <li><tt>:min</tt> count
                  
                  </li>
                  <li><tt>:max</tt> count
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000297-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000297-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 93</span>&#x000A; 93:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>(<span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A; 94:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoAMI</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:ami</span>]&#x000A; 95:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoGroup</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group</span>]&#x000A; 96:         &#x000A; 97:         <span class="ruby-identifier">opts</span> = {&#x000A; 98:           <span class="ruby-identifier">:size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'m1.small'</span>,&#x000A; 99:           <span class="ruby-identifier">:min</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>,&#x000A;100:           <span class="ruby-identifier">:max</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>&#x000A;101:         }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)&#x000A;102:         &#x000A;103:         <span class="ruby-identifier">old_opts</span> = {&#x000A;104:           <span class="ruby-identifier">:image_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:ami</span>].<span class="ruby-identifier">to_s</span>,&#x000A;105:           <span class="ruby-identifier">:min_count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:min</span>],&#x000A;106:           <span class="ruby-identifier">:max_count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:max</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:min</span>],&#x000A;107:           <span class="ruby-identifier">:key_name</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:keypair</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>).<span class="ruby-identifier">to_s</span>,&#x000A;108:           <span class="ruby-identifier">:group_id</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group</span>]].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>,&#x000A;109:           <span class="ruby-comment cmt">#:user_data =&gt; opts[:machine_data],  # Error: Invalid BASE64 encoding of user data ??</span>&#x000A;110:           <span class="ruby-identifier">:availability_zone</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:zone</span>].<span class="ruby-identifier">to_s</span>,&#x000A;111:           <span class="ruby-identifier">:addressing_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:private</span>] <span class="ruby-operator">?</span> <span class="ruby-value str">'private'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'public'</span>,&#x000A;112:           <span class="ruby-identifier">:instance_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:size</span>].<span class="ruby-identifier">to_s</span>,&#x000A;113:           <span class="ruby-identifier">:kernel_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>&#x000A;114:         }&#x000A;115:         <span class="ruby-comment cmt">#p opts[:machine_data]</span>&#x000A;116:         <span class="ruby-comment cmt">#exit</span>&#x000A;117:         &#x000A;118:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">execute_request</span>({}) { <span class="ruby-ivar">@ec2</span>.<span class="ruby-identifier">run_instances</span>(<span class="ruby-identifier">old_opts</span>) }&#x000A;119:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>[<span class="ruby-value str">'instancesSet'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;120:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">response</span>[<span class="ruby-value str">'instancesSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span>&#x000A;121:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-identifier">inst</span>)&#x000A;122:         <span class="ruby-keyword kw">end</span>&#x000A;123:         <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> &#x000A;124:           <span class="ruby-identifier">each_inst</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">inst</span>) &#x000A;125:         } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">each_inst</span>&#x000A;126:         <span class="ruby-identifier">instances</span>&#x000A;127:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000299'>
                <a name='M000299'>      </a>
                <div class='synopsis'>
                  <span class='name'>destroy</span>
                  <span class='arguments'>(inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000299-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000299-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 139</span>&#x000A;139:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;140:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list</span>(<span class="ruby-identifier">:running</span>, <span class="ruby-identifier">inst_ids</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>) <span class="ruby-operator">||</span> [] &#x000A;141:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoRunningInstances</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span>&#x000A;142:       &#x000A;143:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;144:             &#x000A;145:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">execute_request</span>({}) {&#x000A;146:           <span class="ruby-ivar">@ec2</span>.<span class="ruby-identifier">terminate_instances</span>(<span class="ruby-identifier">:instance_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inst_ids</span>)&#x000A;147:         }&#x000A;148:       &#x000A;149:         <span class="ruby-comment cmt">#instancesSet: </span>&#x000A;150:         <span class="ruby-comment cmt">#  item: </span>&#x000A;151:         <span class="ruby-comment cmt">#  - instanceId: i-ebdcb882</span>&#x000A;152:         <span class="ruby-comment cmt">#    shutdownState: </span>&#x000A;153:         <span class="ruby-comment cmt">#      code: &quot;48&quot;</span>&#x000A;154:         <span class="ruby-comment cmt">#      name: terminated</span>&#x000A;155:         <span class="ruby-comment cmt">#    previousState: </span>&#x000A;156:         <span class="ruby-comment cmt">#      code: &quot;48&quot;</span>&#x000A;157:         <span class="ruby-comment cmt">#      name: terminated</span>&#x000A;158:       &#x000A;159:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedResponse</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>[<span class="ruby-value str">'instancesSet'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;160:         <span class="ruby-identifier">instances_shutdown</span> = []&#x000A;161:         <span class="ruby-identifier">response</span>[<span class="ruby-value str">'instancesSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span>&#x000A;162:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">inst</span>[<span class="ruby-value str">'shutdownState'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">inst</span>[<span class="ruby-value str">'shutdownState'</span>][<span class="ruby-value str">'name'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'shutting-down'</span>&#x000A;163:           <span class="ruby-identifier">instances_shutdown</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">inst</span>[<span class="ruby-value str">'instanceId'</span>]&#x000A;164:         <span class="ruby-keyword kw">end</span>&#x000A;165:         <span class="ruby-identifier">success</span> = <span class="ruby-identifier">instances_shutdown</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">inst_ids</span>.<span class="ruby-identifier">size</span>&#x000A;166:         <span class="ruby-identifier">success</span>&#x000A;167:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000301'>
                <a name='M000301'>      </a>
                <div class='synopsis'>
                  <span class='name'>destroy_group</span>
                  <span class='arguments'>(group, &amp;each_inst)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000301-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000301-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 175</span>&#x000A;175:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;176:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-identifier">:running</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>) <span class="ruby-operator">||</span> []&#x000A;177:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">instances</span>)&#x000A;178:         <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">inst_ids</span>, <span class="ruby-identifier">:skip_check</span>)&#x000A;179:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000309'>
                <a name='M000309'>      </a>
                <div class='synopsis'>
                  <span class='name'>device_volume</span>
                  <span class='arguments'>(id, device)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000309-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000309-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 304</span>&#x000A;304:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">device_volume</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">device</span>)&#x000A;305:         <span class="ruby-identifier">volumes</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">device</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">device</span> }&#x000A;306:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000312'>
                <a name='M000312'>      </a>
                <div class='synopsis'>
                  <span class='name'>exists?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000312-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000312-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 321</span>&#x000A;321:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;322:         <span class="ruby-identifier">any?</span>(<span class="ruby-identifier">:any</span>, <span class="ruby-identifier">inst_ids</span>)&#x000A;323:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000310'>
                <a name='M000310'>      </a>
                <div class='synopsis'>
                  <span class='name'>get</span>
                  <span class='arguments'>(inst_id)</span>
                </div>
                <div class='description'>
                  <p>
                  <tt>inst_id</tt> is an instance ID Returns an <a
                  href="Instance.html">Instance</a> object
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000310-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000310-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 310</span>&#x000A;310:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">inst_id</span>)&#x000A;311:         <span class="ruby-identifier">inst_id</span> = <span class="ruby-identifier">inst_id</span>.<span class="ruby-identifier">awsid</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">inst_id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span><span class="ruby-operator">::</span><span class="ruby-constant">Instance</span>)&#x000A;312:         <span class="ruby-identifier">inst</span> = <span class="ruby-identifier">list</span>(<span class="ruby-identifier">:any</span>, <span class="ruby-identifier">inst_id</span>) &#x000A;313:         <span class="ruby-identifier">inst</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">first</span>&#x000A;314:         <span class="ruby-identifier">inst</span>&#x000A;315:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000302'>
                <a name='M000302'>      </a>
                <div class='synopsis'>
                  <span class='name'>list</span>
                  <span class='arguments'>(state=nil, inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>state</tt> is an optional instance state. If specified, must be one of:
                  running (default), pending, terminated.
                  
                  </li>
                  <li><tt>inst_ids</tt> is an Array of instance IDs.
                  
                  </li>
                  </ul>
                  <p>
                  Returns an Array of <a href="Instance.html">Rudy::AWS::EC2::Instance</a>
                  objects.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000302-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000302-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 184</span>&#x000A;184:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list</span>(<span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;185:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_as_hash</span>(<span class="ruby-identifier">state</span>, <span class="ruby-identifier">inst_ids</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;186:         <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">values</span>&#x000A;187:         <span class="ruby-identifier">instances</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Don't return an empty hash</span>&#x000A;188:         <span class="ruby-identifier">instances</span>&#x000A;189:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000305'>
                <a name='M000305'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_as_hash</span>
                  <span class='arguments'>(state=nil, inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>state</tt> is an optional instance state. If specified, must be
                  
                  </li>
                  </ul>
                  <p>
                  one of: running (default), pending, terminated, any
                  </p>
                  <ul>
                  <li><tt>inst_ids</tt> is an Array of instance IDs or <a
                  href="Instance.html">Rudy::AWS::EC2::Instance</a> objects.
                  
                  </li>
                  </ul>
                  <p>
                  Returns a <a href="../../../Hash.html">Hash</a> of <a
                  href="Instance.html">Rudy::AWS::EC2::Instance</a> objects. The key is the
                  instance ID.
                  </p>
                  <ul>
                  <li><tt>each_inst</tt> a block to execute for every instance in the list.
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000305-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000305-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 221</span>&#x000A;221:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_as_hash</span>(<span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;222:         <span class="ruby-identifier">state</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">to_sym</span>&#x000A;223:         <span class="ruby-identifier">state</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:any</span>&#x000A;224:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Unknown state: #{state}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-constant">Instances</span>.<span class="ruby-identifier">known_state?</span>(<span class="ruby-identifier">state</span>)&#x000A;225:         <span class="ruby-identifier">state</span> = <span class="ruby-identifier">:'shutting-down'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:shutting_down</span> <span class="ruby-comment cmt"># EC2 uses a dash</span>&#x000A;226: &#x000A;227:         <span class="ruby-comment cmt"># If we got Instance objects, we want just the IDs.</span>&#x000A;228:         <span class="ruby-comment cmt"># This method always returns an Array.</span>&#x000A;229:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;230:       &#x000A;231:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">execute_request</span>({}) {&#x000A;232:           <span class="ruby-ivar">@ec2</span>.<span class="ruby-identifier">describe_instances</span>(<span class="ruby-identifier">:instance_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inst_ids</span>)&#x000A;233:         }&#x000A;234:       &#x000A;235:         <span class="ruby-comment cmt"># requestId: c16878ac-28e4-4859-9878-ef93af45789c</span>&#x000A;236:         <span class="ruby-comment cmt"># reservationSet: </span>&#x000A;237:         <span class="ruby-comment cmt">#   item: </span>&#x000A;238:         <span class="ruby-comment cmt">#   - reservationId: r-e493148d</span>&#x000A;239:         <span class="ruby-comment cmt">#     groupSet: </span>&#x000A;240:         <span class="ruby-comment cmt">#       item: </span>&#x000A;241:         <span class="ruby-comment cmt">#       - groupId: default</span>&#x000A;242:         <span class="ruby-comment cmt">#     instancesSet: </span>&#x000A;243:         <span class="ruby-comment cmt">#       item:</span>&#x000A;244:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>[<span class="ruby-value str">'reservationSet'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)  <span class="ruby-comment cmt"># No instances </span>&#x000A;245:       &#x000A;246:         <span class="ruby-identifier">resids</span> = []&#x000A;247:         <span class="ruby-identifier">instances</span> = {}&#x000A;248:         <span class="ruby-identifier">response</span>[<span class="ruby-value str">'reservationSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">res</span><span class="ruby-operator">|</span>      &#x000A;249:           <span class="ruby-identifier">resids</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">res</span>[<span class="ruby-value str">'reservationId'</span>]&#x000A;250:           <span class="ruby-identifier">groups</span> = <span class="ruby-identifier">res</span>[<span class="ruby-value str">'groupSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">g</span><span class="ruby-operator">|</span> <span class="ruby-identifier">g</span>[<span class="ruby-value str">'groupId'</span>] }&#x000A;251:           <span class="ruby-comment cmt"># And each reservation can have 1 or more instances</span>&#x000A;252:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">res</span>[<span class="ruby-value str">'instancesSet'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;253:           <span class="ruby-identifier">res</span>[<span class="ruby-value str">'instancesSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">props</span><span class="ruby-operator">|</span>&#x000A;254:             <span class="ruby-identifier">inst</span> = <span class="ruby-constant">Instances</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-identifier">props</span>)&#x000A;255:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">to_s</span>&#x000A;256:             <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">groups</span> = <span class="ruby-identifier">groups</span>&#x000A;257:             <span class="ruby-comment cmt">#puts &quot;STATE: #{inst.state} #{state}&quot;</span>&#x000A;258:             <span class="ruby-identifier">instances</span>[<span class="ruby-identifier">inst</span>.<span class="ruby-identifier">awsid</span>] = <span class="ruby-identifier">inst</span>&#x000A;259:           <span class="ruby-keyword kw">end</span>&#x000A;260:         <span class="ruby-keyword kw">end</span>&#x000A;261:         &#x000A;262:         <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">each_value</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> <span class="ruby-identifier">each_inst</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">inst</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">each_inst</span>&#x000A;263:         &#x000A;264:         <span class="ruby-identifier">instances</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Don't return an empty hash</span>&#x000A;265:         <span class="ruby-identifier">instances</span>&#x000A;266:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000303'>
                <a name='M000303'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_group</span>
                  <span class='arguments'>(group=nil, state=nil, inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>group</tt> is a security group name.
                  
                  </li>
                  <li><tt>state</tt> is an optional instance state. If specified, must be one of:
                  running (default), pending, terminated.
                  
                  </li>
                  <li><tt>inst_ids</tt> is an Array of instance IDs.
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000303-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000303-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 194</span>&#x000A;194:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_group</span>(<span class="ruby-identifier">group</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;195:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_group_as_hash</span>(<span class="ruby-identifier">group</span>, <span class="ruby-identifier">state</span>, <span class="ruby-identifier">inst_ids</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;196:         <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">values</span>&#x000A;197:         <span class="ruby-identifier">instances</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Don't return an empty hash</span>&#x000A;198:         <span class="ruby-identifier">instances</span>&#x000A;199:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000304'>
                <a name='M000304'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_group_as_hash</span>
                  <span class='arguments'>(group=nil, state=nil, inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>group</tt> is a security group name.
                  
                  </li>
                  <li><tt>state</tt> is an optional instance state. If specified, must be one of:
                  running (default), pending, terminated.
                  
                  </li>
                  <li><tt>inst_ids</tt> is an Array of instance IDs.
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000304-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000304-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 205</span>&#x000A;205:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_group_as_hash</span>(<span class="ruby-identifier">group</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;206:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_as_hash</span>(<span class="ruby-identifier">state</span>, <span class="ruby-identifier">inst_ids</span>)&#x000A;207:         <span class="ruby-comment cmt"># Remove instances that are not in the specified group</span>&#x000A;208:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span>&#x000A;209:           <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">reject</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">id</span>,<span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">inst</span>.<span class="ruby-identifier">groups</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">group</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">group</span>&#x000A;210:           <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">each_value</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> <span class="ruby-identifier">each_inst</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">inst</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">each_inst</span>&#x000A;211:         <span class="ruby-keyword kw">end</span>&#x000A;212:         <span class="ruby-identifier">instances</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Don't return an empty hash</span>&#x000A;213:         <span class="ruby-identifier">instances</span>&#x000A;214:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000315'>
                <a name='M000315'>      </a>
                <div class='synopsis'>
                  <span class='name'>pending?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000315-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000315-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 333</span>&#x000A;333:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pending?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;334:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">list</span>(<span class="ruby-identifier">:pending</span>, <span class="ruby-identifier">inst_ids</span>), <span class="ruby-identifier">inst_ids</span>)&#x000A;335:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000298'>
                <a name='M000298'>      </a>
                <div class='synopsis'>
                  <span class='name'>restart</span>
                  <span class='arguments'>(inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000298-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000298-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 129</span>&#x000A;129:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">restart</span>(<span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;130:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list</span>(<span class="ruby-identifier">:running</span>, <span class="ruby-identifier">inst_ids</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>) <span class="ruby-operator">||</span> []&#x000A;131:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoRunningInstances</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span>&#x000A;132:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;133:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">execute_request</span>({}) {&#x000A;134:           <span class="ruby-ivar">@ec2</span>.<span class="ruby-identifier">reboot_instances</span>(<span class="ruby-identifier">:instance_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inst_ids</span>)&#x000A;135:         }&#x000A;136:         <span class="ruby-identifier">response</span>[<span class="ruby-value str">'return'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'true'</span>&#x000A;137:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000300'>
                <a name='M000300'>      </a>
                <div class='synopsis'>
                  <span class='name'>restart_group</span>
                  <span class='arguments'>(group, &amp;each_inst)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000300-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000300-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 169</span>&#x000A;169:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">restart_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;170:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-identifier">:running</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>) <span class="ruby-operator">||</span> []&#x000A;171:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">instances</span>)&#x000A;172:         <span class="ruby-identifier">restart</span>(<span class="ruby-identifier">inst_ids</span>, <span class="ruby-identifier">:skip_check</span>)&#x000A;173:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000314'>
                <a name='M000314'>      </a>
                <div class='synopsis'>
                  <span class='name'>running?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000314-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000314-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 330</span>&#x000A;330:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">running?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;331:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">list</span>(<span class="ruby-identifier">:running</span>, <span class="ruby-identifier">inst_ids</span>), <span class="ruby-identifier">inst_ids</span>)&#x000A;332:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000317'>
                <a name='M000317'>      </a>
                <div class='synopsis'>
                  <span class='name'>shutting_down?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000317-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000317-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 339</span>&#x000A;339:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">shutting_down?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;340:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">list</span>(<span class="ruby-identifier">:shutting_down</span>, <span class="ruby-identifier">inst_ids</span>), <span class="ruby-identifier">inst_ids</span>)&#x000A;341:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000316'>
                <a name='M000316'>      </a>
                <div class='synopsis'>
                  <span class='name'>terminated?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000316-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000316-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 336</span>&#x000A;336:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">terminated?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;337:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">list</span>(<span class="ruby-identifier">:terminated</span>, <span class="ruby-identifier">inst_ids</span>), <span class="ruby-identifier">inst_ids</span>)&#x000A;338:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000318'>
                <a name='M000318'>      </a>
                <div class='synopsis'>
                  <span class='name'>unavailable?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000318-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000318-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 343</span>&#x000A;343:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unavailable?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;344:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list</span>(<span class="ruby-identifier">:any</span>, <span class="ruby-identifier">inst_ids</span>) <span class="ruby-operator">||</span> []&#x000A;345:         <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">reject!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> &#x000A;346:           (<span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;shutting-down&quot;</span> <span class="ruby-operator">||</span> &#x000A;347:            <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;pending&quot;</span> <span class="ruby-operator">||</span> &#x000A;348:            <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;terminated&quot;</span>) &#x000A;349:         }&#x000A;350:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">instances</span>, <span class="ruby-identifier">inst_ids</span>)&#x000A;351:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000308'>
                <a name='M000308'>      </a>
                <div class='synopsis'>
                  <span class='name'>volumes</span>
                  <span class='arguments'>(id)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000308-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000308-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 297</span>&#x000A;297:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">volumes</span>(<span class="ruby-identifier">id</span>)&#x000A;298:         <span class="ruby-identifier">rvol</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span><span class="ruby-operator">::</span><span class="ruby-constant">Volumes</span>.<span class="ruby-identifier">new</span>&#x000A;299:         <span class="ruby-identifier">rvol</span>.<span class="ruby-identifier">ec2</span> = <span class="ruby-ivar">@ec2</span> &#x000A;300:         <span class="ruby-identifier">rvol</span>.<span class="ruby-identifier">list</span> <span class="ruby-operator">||</span> []&#x000A;301:         <span class="ruby-identifier">list</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">attached?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">instid</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">id</span> }&#x000A;302:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
