<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Rudy::AWS::SDB [Rudy: Not your grandparents' EC2 deployment tool.]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Rudy::AWS::SDB
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../files/lib/rudy/aws/sdb/error_rb.html">lib/rudy/aws/sdb/error.rb</a>
          </li>
          <li class='other'>
            <a href="../../../files/lib/rudy/aws/sdb_rb.html">lib/rudy/aws/sdb.rb</a>
          </li>
          <li>
            <a class='show' href='#' onclick='this.parentNode.parentNode.className += " expanded"; this.parentNode.removeChild(this); return false'>show all</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000354">generate_query</a></li>
              <li><a href="#M000353">generate_select</a></li>
              <li><a href="#M000349">new</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000351">create_domain</a></li>
              <li><a href="#M000362">delete_attributes</a></li>
              <li><a href="#M000363">destroy</a></li>
              <li><a href="#M000352">destroy_domain</a></li>
              <li><a href="#M000361">get</a></li>
              <li><a href="#M000360">get_attributes</a></li>
              <li><a href="#M000350">list_domains</a></li>
              <li><a href="#M000359">put</a></li>
              <li><a href="#M000358">put_attributes</a></li>
              <li><a href="#M000356">query</a></li>
              <li><a href="#M000357">query_with_attributes</a></li>
              <li><a href="#M000355">select</a></li>
            </ol>
            <h3>protected instance</h3>
            <ol>
              <li><a href="#M000364">call</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li><a href="ObjectBase.html">Rudy::AWS::ObjectBase</a></li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Class <a href="SDB/ConnectionError.html" class="link">Rudy::AWS::SDB::ConnectionError</a><br />
              Class <a href="SDB/Error.html" class="link">Rudy::AWS::SDB::Error</a><br />
              Class <a href="SDB/FeatureDeprecatedError.html" class="link">Rudy::AWS::SDB::FeatureDeprecatedError</a><br />
              Class <a href="SDB/InvalidDomainNameError.html" class="link">Rudy::AWS::SDB::InvalidDomainNameError</a><br />
              Class <a href="SDB/InvalidNextTokenError.html" class="link">Rudy::AWS::SDB::InvalidNextTokenError</a><br />
              Class <a href="SDB/InvalidNumberPredicatesError.html" class="link">Rudy::AWS::SDB::InvalidNumberPredicatesError</a><br />
              Class <a href="SDB/InvalidNumberValueTestsError.html" class="link">Rudy::AWS::SDB::InvalidNumberValueTestsError</a><br />
              Class <a href="SDB/InvalidParameterValueError.html" class="link">Rudy::AWS::SDB::InvalidParameterValueError</a><br />
              Class <a href="SDB/InvalidQueryExpressionError.html" class="link">Rudy::AWS::SDB::InvalidQueryExpressionError</a><br />
              Class <a href="SDB/MissingParameterError.html" class="link">Rudy::AWS::SDB::MissingParameterError</a><br />
              Class <a href="SDB/NoAccessKey.html" class="link">Rudy::AWS::SDB::NoAccessKey</a><br />
              Class <a href="SDB/NoSecretKey.html" class="link">Rudy::AWS::SDB::NoSecretKey</a><br />
              Class <a href="SDB/NoSuchDomainError.html" class="link">Rudy::AWS::SDB::NoSuchDomainError</a><br />
              Class <a href="SDB/NumberDomainAttributesExceededError.html" class="link">Rudy::AWS::SDB::NumberDomainAttributesExceededError</a><br />
              Class <a href="SDB/NumberDomainBytesExceededError.html" class="link">Rudy::AWS::SDB::NumberDomainBytesExceededError</a><br />
              Class <a href="SDB/NumberDomainsExceededError.html" class="link">Rudy::AWS::SDB::NumberDomainsExceededError</a><br />
              Class <a href="SDB/NumberItemAttributesExceededError.html" class="link">Rudy::AWS::SDB::NumberItemAttributesExceededError</a><br />
              Class <a href="SDB/RequestError.html" class="link">Rudy::AWS::SDB::RequestError</a><br />
              Class <a href="SDB/RequestTimeoutError.html" class="link">Rudy::AWS::SDB::RequestTimeoutError</a><br />
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='public-class method' id='method-M000354'>
                <a name='M000354'>      </a>
                <div class='synopsis'>
                  <span class='name'>generate_query</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='description'>
                  <p>
                  Takes a zipped Array or <a href="../../Hash.html">Hash</a> of criteria.
                  Returns a string suitable for a SimpleDB Query
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000354-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000354-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 81</span>&#x000A;81:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">generate_query</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;82:         <span class="ruby-identifier">q</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)<span class="ruby-operator">?</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>]&#x000A;83:         <span class="ruby-identifier">query</span> = []&#x000A;84:         <span class="ruby-identifier">q</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> &#x000A;85:           <span class="ruby-identifier">query</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;['#{Rudy::AWS.escape n}'='#{Rudy::AWS.escape v}']&quot;</span>&#x000A;86:         <span class="ruby-keyword kw">end</span>&#x000A;87:         <span class="ruby-identifier">query</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; intersection &quot;</span>)&#x000A;88:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-class method' id='method-M000353'>
                <a name='M000353'>      </a>
                <div class='synopsis'>
                  <span class='name'>generate_select</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='description'>
                  <p>
                  Takes a zipped Array or <a href="../../Hash.html">Hash</a> of criteria.
                  Returns a string suitable for a SimpleDB Select
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000353-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000353-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 68</span>&#x000A;68:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">generate_select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;69:         <span class="ruby-identifier">fields</span>, <span class="ruby-identifier">domain</span>, <span class="ruby-identifier">args</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>&#x000A;70:         <span class="ruby-identifier">q</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">args</span> <span class="ruby-operator">:</span> <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>]&#x000A;71:         <span class="ruby-identifier">query</span> = []&#x000A;72:         <span class="ruby-identifier">q</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> &#x000A;73:           <span class="ruby-identifier">query</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{Rudy::AWS.escape n}='#{Rudy::AWS.escape v}'&quot;</span>&#x000A;74:         <span class="ruby-keyword kw">end</span>&#x000A;75:         <span class="ruby-node">&quot;select * from #{domain} where &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">query</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' and '</span>)&#x000A;76:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-class method' id='method-M000349'>
                <a name='M000349'>      </a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(access_key=nil, secret_key=nil, region=nil, debug=nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000349-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000349-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 20</span>&#x000A;20:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">access_key</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">secret_key</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">region</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">debug</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;21:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoAccessKey</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">access_key</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">access_key</span>.<span class="ruby-identifier">empty?</span>&#x000A;22:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoSecretKey</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">secret_key</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">secret_key</span>.<span class="ruby-identifier">empty?</span>&#x000A;23:           &#x000A;24:         <span class="ruby-identifier">url</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">'http://sdb.amazonaws.com'</span>&#x000A;25:         <span class="ruby-comment cmt"># There is a bug with passing :server to EC2::Base.new so </span>&#x000A;26:         <span class="ruby-comment cmt"># we'll use the environment variable for now. </span>&#x000A;27:         <span class="ruby-comment cmt">#if region &amp;&amp; Rudy::AWS.valid_region?(region)</span>&#x000A;28:         <span class="ruby-comment cmt">#  &quot;#{region}.sdb.amazonaws.com&quot;</span>&#x000A;29:         <span class="ruby-comment cmt">#end</span>&#x000A;30:         &#x000A;31:         <span class="ruby-ivar">@access_key_id</span> = <span class="ruby-identifier">access_key</span> <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'AWS_ACCESS_KEY'</span>]&#x000A;32:         <span class="ruby-ivar">@secret_access_key</span> = <span class="ruby-identifier">secret_key</span> <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'AWS_SECRET_KEY'</span>]&#x000A;33:         <span class="ruby-ivar">@base_url</span> = <span class="ruby-identifier">url</span>&#x000A;34:         <span class="ruby-ivar">@debug</span> = <span class="ruby-identifier">debug</span> <span class="ruby-operator">||</span> <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>&#x000A;35:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000351'>
                <a name='M000351'>      </a>
                <div class='synopsis'>
                  <span class='name'>create_domain</span>
                  <span class='arguments'>(domain)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000351-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000351-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 52</span>&#x000A;52:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_domain</span>(<span class="ruby-identifier">domain</span>)&#x000A;53:         <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:post</span>, { <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'CreateDomain'</span>, <span class="ruby-value str">'DomainName'</span>=<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span> })&#x000A;54:         <span class="ruby-keyword kw">true</span>&#x000A;55:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000362'>
                <a name='M000362'>      </a>
                <div class='synopsis'>
                  <span class='name'>delete_attributes</span>
                  <span class='arguments'>(domain, item)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000362-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000362-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 238</span>&#x000A;238:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_attributes</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">item</span>)&#x000A;239:         <span class="ruby-identifier">call</span>(&#x000A;240:           <span class="ruby-identifier">:delete</span>,&#x000A;241:           {&#x000A;242:             <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'DeleteAttributes'</span>,&#x000A;243:             <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>,&#x000A;244:             <span class="ruby-value str">'ItemName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">to_s</span>&#x000A;245:           }&#x000A;246:         )&#x000A;247:         <span class="ruby-keyword kw">true</span>&#x000A;248:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000363'>
                <a name='M000363'>      </a>
                <div class='synopsis'>
                  <span class='name'>destroy</span>
                  <span class='arguments'>(domain, item)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="SDB.html#M000362">delete_attributes</a>
                  </p>
                </div>
              </div>
              <div class='public-instance method' id='method-M000352'>
                <a name='M000352'>      </a>
                <div class='synopsis'>
                  <span class='name'>destroy_domain</span>
                  <span class='arguments'>(domain)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000352-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000352-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 57</span>&#x000A;57:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy_domain</span>(<span class="ruby-identifier">domain</span>)&#x000A;58:         <span class="ruby-identifier">call</span>(&#x000A;59:           <span class="ruby-identifier">:delete</span>,&#x000A;60:           { <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'DeleteDomain'</span>, <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span> }&#x000A;61:         )&#x000A;62:         <span class="ruby-keyword kw">true</span>&#x000A;63:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000361'>
                <a name='M000361'>      </a>
                <div class='synopsis'>
                  <span class='name'>get</span>
                  <span class='arguments'>(domain, item)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="SDB.html#M000360">get_attributes</a>
                  </p>
                </div>
              </div>
              <div class='public-instance method' id='method-M000360'>
                <a name='M000360'>      </a>
                <div class='synopsis'>
                  <span class='name'>get_attributes</span>
                  <span class='arguments'>(domain, item)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000360-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000360-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 215</span>&#x000A;215:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_attributes</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">item</span>)&#x000A;216:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">call</span>(&#x000A;217:           <span class="ruby-identifier">:get</span>,&#x000A;218:           {&#x000A;219:             <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'GetAttributes'</span>,&#x000A;220:             <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>,&#x000A;221:             <span class="ruby-value str">'ItemName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">to_s</span>&#x000A;222:           }&#x000A;223:         )&#x000A;224:         <span class="ruby-identifier">attributes</span> = {}&#x000A;225:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>&#x000A;226:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-value str">&quot;//Attribute&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>&#x000A;227:             <span class="ruby-identifier">key</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Name/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;228:             <span class="ruby-identifier">value</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Value/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;229:             ( <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||=</span> [] ) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>&#x000A;230:           <span class="ruby-keyword kw">end</span>&#x000A;231:         <span class="ruby-keyword kw">end</span>&#x000A;232:         <span class="ruby-identifier">attributes</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">empty?</span>&#x000A;233:         <span class="ruby-identifier">attributes</span>&#x000A;234:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000350'>
                <a name='M000350'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_domains</span>
                  <span class='arguments'>(max = nil, token = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000350-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000350-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 37</span>&#x000A;37:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_domains</span>(<span class="ruby-identifier">max</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;38:         <span class="ruby-identifier">params</span> = { <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'ListDomains'</span> }&#x000A;39:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'NextToken'</span>] =&#x000A;40:           <span class="ruby-identifier">token</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">empty?</span>&#x000A;41:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'MaxNumberOfDomains'</span>] =&#x000A;42:           <span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">max</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;43:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">params</span>)&#x000A;44:         <span class="ruby-identifier">results</span> = []&#x000A;45:         <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-value str">'//DomainName/text()'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">domain</span><span class="ruby-operator">|</span>&#x000A;46:           <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>&#x000A;47:         <span class="ruby-keyword kw">end</span>&#x000A;48:         <span class="ruby-comment cmt">#return results, REXML::XPath.first(doc, '//NextToken/text()').to_s</span>&#x000A;49:         <span class="ruby-identifier">results</span>&#x000A;50:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000359'>
                <a name='M000359'>      </a>
                <div class='synopsis'>
                  <span class='name'>put</span>
                  <span class='arguments'>(domain, item, attributes, replace = true)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="SDB.html#M000358">put_attributes</a>
                  </p>
                </div>
              </div>
              <div class='public-instance method' id='method-M000358'>
                <a name='M000358'>      </a>
                <div class='synopsis'>
                  <span class='name'>put_attributes</span>
                  <span class='arguments'>(domain, item, attributes, replace = true)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000358-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000358-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 191</span>&#x000A;191:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">put_attributes</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">item</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">replace</span> = <span class="ruby-keyword kw">true</span>)&#x000A;192:         <span class="ruby-identifier">replace</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">replace</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:replace</span>&#x000A;193:         <span class="ruby-identifier">params</span> = {&#x000A;194:           <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'PutAttributes'</span>,&#x000A;195:           <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>,&#x000A;196:           <span class="ruby-value str">'ItemName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">to_s</span>&#x000A;197:         }&#x000A;198:         <span class="ruby-identifier">count</span> = <span class="ruby-value">0</span>&#x000A;199:         &#x000A;200:         <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>, <span class="ruby-identifier">values</span> <span class="ruby-operator">|</span>&#x000A;201:           ([]<span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">values</span>).<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span>&#x000A;202:             <span class="ruby-identifier">params</span>[<span class="ruby-node">&quot;Attribute.#{count}.Name&quot;</span>] = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>&#x000A;203:             <span class="ruby-identifier">params</span>[<span class="ruby-node">&quot;Attribute.#{count}.Value&quot;</span>] = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>&#x000A;204:             <span class="ruby-identifier">params</span>[<span class="ruby-node">&quot;Attribute.#{count}.Replace&quot;</span>] = <span class="ruby-identifier">replace</span>&#x000A;205:             <span class="ruby-identifier">count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;206:           <span class="ruby-keyword kw">end</span>&#x000A;207:         <span class="ruby-keyword kw">end</span>&#x000A;208:         &#x000A;209:         <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:put</span>, <span class="ruby-identifier">params</span>)&#x000A;210:         &#x000A;211:         <span class="ruby-keyword kw">true</span>&#x000A;212:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000356'>
                <a name='M000356'>      </a>
                <div class='synopsis'>
                  <span class='name'>query</span>
                  <span class='arguments'>(domain, query, max = nil, token = nil)</span>
                </div>
                <div class='description'>
                  <p>
                  <QueryResult><ItemName>in-c2ffrw</ItemName><ItemName>in-72yagt</ItemName><ItemName>in-52j8gj</ItemName>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000356-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000356-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 125</span>&#x000A;125:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">max</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;126:         <span class="ruby-identifier">params</span> = {&#x000A;127:           <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Query'</span>,&#x000A;128:           <span class="ruby-value str">'QueryExpression'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">query</span>,&#x000A;129:           <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>&#x000A;130:         }&#x000A;131:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'NextToken'</span>] =&#x000A;132:           <span class="ruby-identifier">token</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">empty?</span>&#x000A;133:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'MaxNumberOfItems'</span>] =&#x000A;134:           <span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">max</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;135: &#x000A;136: &#x000A;137:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">params</span>)&#x000A;138:         <span class="ruby-identifier">results</span> = []&#x000A;139:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>&#x000A;140:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-value str">'//ItemName/text()'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>&#x000A;141:             <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">to_s</span>&#x000A;142:           <span class="ruby-keyword kw">end</span>&#x000A;143:         <span class="ruby-keyword kw">end</span>&#x000A;144:         &#x000A;145:         <span class="ruby-comment cmt">#return results, REXML::XPath.first(doc, '//NextToken/text()').to_s</span>&#x000A;146:         <span class="ruby-identifier">results</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">results</span>&#x000A;147:         &#x000A;148:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000357'>
                <a name='M000357'>      </a>
                <div class='synopsis'>
                  <span class='name'>query_with_attributes</span>
                  <span class='arguments'>(domain, query, max = nil, token = nil)</span>
                </div>
                <div class='description'>
                  <p>
                  <QueryWithAttributesResult><Item><Name>in-c2ffrw</Name><Attribute><Name>code</Name><Value>in-c2ffrw</Value></Attribute><Attribute><Name>date_created</Name><Value>2008-10-31</Value></Attribute></Item><Item>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000357-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000357-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 153</span>&#x000A;153:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query_with_attributes</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">query</span>, <span class="ruby-identifier">max</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;154:         <span class="ruby-identifier">params</span> = {&#x000A;155:           <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'QueryWithAttributes'</span>,&#x000A;156:           <span class="ruby-value str">'QueryExpression'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">query</span>,&#x000A;157:           <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>&#x000A;158:         }&#x000A;159:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'NextToken'</span>] =&#x000A;160:           <span class="ruby-identifier">token</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">empty?</span>&#x000A;161:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'MaxNumberOfItems'</span>] =&#x000A;162:           <span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">max</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;163: &#x000A;164:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">params</span>)&#x000A;165:         <span class="ruby-identifier">results</span> = []&#x000A;166:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>&#x000A;167:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-value str">&quot;//Item&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>&#x000A;168:             <span class="ruby-identifier">name</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">item</span>, <span class="ruby-value str">'./Name/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;169: &#x000A;170:             <span class="ruby-identifier">attributes</span> = {<span class="ruby-value str">'Name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>}&#x000A;171:             <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">item</span>, <span class="ruby-value str">&quot;./Attribute&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>&#x000A;172:               <span class="ruby-identifier">key</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Name/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;173:               <span class="ruby-identifier">value</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Value/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;174:               ( <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||=</span> [] ) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>&#x000A;175:             <span class="ruby-keyword kw">end</span>&#x000A;176:             <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">attributes</span>&#x000A;177:           <span class="ruby-keyword kw">end</span>&#x000A;178:           <span class="ruby-comment cmt">#return results, REXML::XPath.first(doc, '//NextToken/text()').to_s</span>&#x000A;179:         <span class="ruby-keyword kw">end</span>&#x000A;180:         &#x000A;181:         <span class="ruby-identifier">hash_results</span> = {}&#x000A;182:         <span class="ruby-identifier">results</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>&#x000A;183:           <span class="ruby-identifier">hash_results</span>[<span class="ruby-identifier">item</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value str">'Name'</span>)] = <span class="ruby-identifier">item</span>&#x000A;184:         <span class="ruby-keyword kw">end</span>&#x000A;185:         &#x000A;186:         <span class="ruby-identifier">hash_results</span>&#x000A;187:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000355'>
                <a name='M000355'>      </a>
                <div class='synopsis'>
                  <span class='name'>select</span>
                  <span class='arguments'>(select, token = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000355-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000355-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 91</span>&#x000A; 91:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select</span>(<span class="ruby-identifier">select</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>)&#x000A; 92:         <span class="ruby-identifier">params</span> = {&#x000A; 93:           <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Select'</span>,&#x000A; 94:           <span class="ruby-value str">'SelectExpression'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">select</span>,&#x000A; 95:         }&#x000A; 96:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'NextToken'</span>] =&#x000A; 97:           <span class="ruby-identifier">token</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">empty?</span>&#x000A; 98:           &#x000A; 99:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">params</span>)&#x000A;100:         <span class="ruby-identifier">results</span> = []&#x000A;101:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>&#x000A;102:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-value str">&quot;//Item&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>&#x000A;103:             <span class="ruby-identifier">name</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">item</span>, <span class="ruby-value str">'./Name/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;104: &#x000A;105:             <span class="ruby-identifier">attributes</span> = {<span class="ruby-value str">'Name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>}&#x000A;106:             <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">item</span>, <span class="ruby-value str">&quot;./Attribute&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>&#x000A;107:               <span class="ruby-identifier">key</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Name/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;108:               <span class="ruby-identifier">value</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Value/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;109:               ( <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||=</span> [] ) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>&#x000A;110:             <span class="ruby-keyword kw">end</span>&#x000A;111:             <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">attributes</span>&#x000A;112:           <span class="ruby-keyword kw">end</span>&#x000A;113:           <span class="ruby-comment cmt">#return results, REXML::XPath.first(doc, '//NextToken/text()').to_s</span>&#x000A;114:         <span class="ruby-keyword kw">end</span>&#x000A;115:         &#x000A;116:         <span class="ruby-identifier">hash_results</span> = {}&#x000A;117:         <span class="ruby-identifier">results</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>&#x000A;118:           <span class="ruby-identifier">hash_results</span>[<span class="ruby-identifier">item</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value str">'Name'</span>)] = <span class="ruby-identifier">item</span>&#x000A;119:         <span class="ruby-keyword kw">end</span>&#x000A;120:         &#x000A;121:         <span class="ruby-identifier">hash_results</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">hash_results</span>&#x000A;122:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Protected instance methods</h2>
              <div class='protected-instance method' id='method-M000364'>
                <a name='M000364'>      </a>
                <div class='synopsis'>
                  <span class='name'>call</span>
                  <span class='arguments'>(method, params)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000364-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000364-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 255</span>&#x000A;255:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">params</span>)&#x000A;256:         <span class="ruby-identifier">params</span>.<span class="ruby-identifier">merge!</span>( {&#x000A;257:             <span class="ruby-value str">'Version'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'2007-11-07'</span>,&#x000A;258:             <span class="ruby-value str">'SignatureVersion'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'1'</span>,&#x000A;259:             <span class="ruby-value str">'AWSAccessKeyId'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@access_key_id</span>,&#x000A;260:             <span class="ruby-value str">'Timestamp'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">gmtime</span>.<span class="ruby-identifier">iso8601</span>&#x000A;261:           }&#x000A;262:         )&#x000A;263:         <span class="ruby-identifier">data</span> = <span class="ruby-value str">''</span>&#x000A;264:         <span class="ruby-identifier">query</span> = []&#x000A;265:         &#x000A;266:         <span class="ruby-identifier">params</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">upcase</span> }.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>&#x000A;267:           <span class="ruby-identifier">data</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{key}#{params[key].to_s}&quot;</span>&#x000A;268:           <span class="ruby-identifier">query</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{key}=#{CGI::escape(params[key].to_s)}&quot;</span>&#x000A;269:         <span class="ruby-keyword kw">end</span>&#x000A;270:         &#x000A;271:         <span class="ruby-identifier">digest</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'sha1'</span>)&#x000A;272:         <span class="ruby-identifier">hmac</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">HMAC</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-identifier">digest</span>, <span class="ruby-ivar">@secret_access_key</span>, <span class="ruby-identifier">data</span>)&#x000A;273:         <span class="ruby-identifier">signature</span> = <span class="ruby-constant">Base64</span>.<span class="ruby-identifier">encode64</span>(<span class="ruby-identifier">hmac</span>).<span class="ruby-identifier">strip</span>&#x000A;274:         <span class="ruby-identifier">query</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;Signature=#{CGI::escape(signature)}&quot;</span>&#x000A;275:         <span class="ruby-identifier">query</span> = <span class="ruby-identifier">query</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'&amp;'</span>)&#x000A;276:         <span class="ruby-identifier">url</span> = <span class="ruby-node">&quot;#{@base_url}?#{query}&quot;</span>&#x000A;277:         <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">url</span>)&#x000A;278:         <span class="ruby-ivar">@debug</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-node">&quot;#{url}&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug</span>&#x000A;279:         &#x000A;280:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">execute_request</span>(<span class="ruby-keyword kw">nil</span>) {&#x000A;281:           <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>).<span class="ruby-identifier">send_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">request_uri</span>)&#x000A;282:         }&#x000A;283:         &#x000A;284:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">response</span>.<span class="ruby-identifier">nil?</span>&#x000A;285:         &#x000A;286:           <span class="ruby-ivar">@debug</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-node">&quot;#{response.code}\n#{response.body}&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug</span>&#x000A;287:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ConnectionError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">response</span>)) <span class="ruby-keyword kw">unless</span> (<span class="ruby-value">200</span><span class="ruby-operator">..</span><span class="ruby-value">400</span>).<span class="ruby-identifier">include?</span>(&#x000A;288:             <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>.<span class="ruby-identifier">to_i</span>&#x000A;289:           )&#x000A;290: &#x000A;291: &#x000A;292:           <span class="ruby-identifier">doc</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>)&#x000A;293:           <span class="ruby-identifier">error</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">get_elements</span>(<span class="ruby-value str">'*/Errors/Error'</span>)[<span class="ruby-value">0</span>]&#x000A;294:           <span class="ruby-identifier">raise</span>(&#x000A;295:             <span class="ruby-constant">Module</span>.<span class="ruby-identifier">class_eval</span>(&#x000A;296:               <span class="ruby-node">&quot;AwsSdb::#{error.get_elements('Code')[0].text}Error&quot;</span>&#x000A;297:             ).<span class="ruby-identifier">new</span>(&#x000A;298:               <span class="ruby-identifier">error</span>.<span class="ruby-identifier">get_elements</span>(<span class="ruby-value str">'Message'</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">text</span>,&#x000A;299:               <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">get_elements</span>(<span class="ruby-value str">'*/RequestID'</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">text</span>&#x000A;300:             )&#x000A;301:           ) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">error</span>.<span class="ruby-identifier">nil?</span>&#x000A;302:         <span class="ruby-keyword kw">else</span>&#x000A;303:           <span class="ruby-identifier">doc</span> = <span class="ruby-keyword kw">nil</span>&#x000A;304:         <span class="ruby-keyword kw">end</span>&#x000A;305:         <span class="ruby-identifier">doc</span>&#x000A;306:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
